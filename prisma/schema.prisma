// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

enum CardStatus {
  CREATED
  UNBOUND
  NORMAL
  CANCELED
  BLOCKED
}

enum CardType {
  PLASTIC
  VIRTUAL 
}

model User {
  id    Int     @id @default(autoincrement())
  email String  @unique
  name  String?
  posts Post[]
}

model Post {
  id        Int     @id @default(autoincrement())
  title     String
  content   String?
  published Boolean @default(false)
  author    User    @relation(fields: [authorId], references: [id])
  authorId  Int
}

model Account {
  id        String           @id @default(uuid())
  name      String
  document  String           @unique
  addresses AccountAddress[]
  phones    AccountPhone[]
  cards     Card[]
  customers Customer[]
  authCode  String?
  expiresAt DateTime?
  token     String?

  application_id     Int?
  status             Boolean @default(true)
  status_name        String?
  account_id         Int?
  customer_id        Int?
  entity_id          Int?
  program_id         Int?
  program            Program? @relation(fields: [program_id], references: [id])
  due_date_id        Int?
  due_date_day       Int?
  max_credit_limit   Float?
  total_credit_limit Float?
  accrual_status     String?
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt
}

model AccountPhone {
  id           String   @id @default(uuid())
  phone        String   @unique
  phone_type   String
  country_code String
  area_code    Int
  active       Boolean
  account      Account? @relation(fields: [accountId], references: [id])

  accountId String?
}

model AccountAddress {
  id                    String   @id @default(uuid())
  address               String
  number                Int
  country_code          String
  country               String
  neighborhood          String
  city                  String
  state                 String
  zip_code              String
  address_type          String
  complementary_address String?
  mailing_address       Boolean
  active                Boolean
  account               Account? @relation(fields: [accountId], references: [id])

  accountId String?
}

model Program {
  id         Int       @id @default(autoincrement())
  name       String
  is_active  Boolean
  program_id Int
  due_dates  DueDate[]
  createdAt  DateTime  @default(now())
  updatedAt  DateTime  @updatedAt

  accounts Account[]
}

model DueDate {
  id          Int     @id @default(autoincrement())
  day         Int
  active      Boolean
  due_date_id Int
  programId   Int
  program     Program @relation(fields: [programId], references: [id])
}

model Card {
  id                          String   @id @default(uuid())
  name                        String
  type                        String
  status                      String
  printed_name                String?
  last_four_digits            String?
  expiration_date             DateTime?
  isDependentCard             Boolean?
  isNoNameCard                Boolean?
  bulkId                      String?
  cvv_rotation_interval_hours Int?
  transaction_limit           Float?
  abu_enabled                 Boolean?
  mode_type                   String?

  logo                 String?
  hasChangedPassword   Boolean?
  lastNormalStatusDate DateTime?
  trackingCode         String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  account   Account? @relation(fields: [accountId], references: [id])
  accountId String?

  customer   Customer? @relation(fields: [customerId], references: [id])
  customerId String?
}

model Customer {
  id        String   @id @default(uuid())
  name      String
  accountId String?
  cards     Card[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  account Account? @relation(fields: [accountId], references: [id])
}
